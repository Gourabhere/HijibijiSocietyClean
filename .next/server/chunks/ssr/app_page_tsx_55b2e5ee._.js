module.exports=[60350,a=>{"use strict";var b,c,d,e=a.i(87924),f=a.i(72131);let g=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim(),h=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let j=(0,f.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:e="",children:h,iconNode:j,...k},l)=>(0,f.createElement)("svg",{ref:l,...i,width:b,height:b,stroke:a,strokeWidth:d?24*Number(c)/Number(b):c,className:g("lucide",e),...!h&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0;return!1})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,b])=>(0,f.createElement)(a,b)),...Array.isArray(h)?h:[h]])),k=(a,b)=>{let c=(0,f.forwardRef)(({className:c,...d},e)=>(0,f.createElement)(j,{ref:e,iconNode:b,className:g(`lucide-${h(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,c),...d}));return c.displayName=h(a),c},l=k("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),m=k("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),n=k("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),o=k("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),p=k("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),q=k("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),r=k("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),s=k("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),t=k("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),u=k("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function v(a){(0,f.useEffect)(()=>{var b;a.beforeSend&&(null==(b=window.si)||b.call(window,"beforeSend",a.beforeSend))},[a.beforeSend]);let b=(0,f.useRef)(null);return(0,f.useEffect)(()=>{if(b.current)a.route&&b.current(a.route);else{let c=function(a={}){return null}({framework:a.framework??"react",basePath:a.basePath??function(){if("u">typeof process&&void 0!==process.env)return process.env.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}(),...a});c&&(b.current=c.setRoute)}},[a.route]),null}var w=a.i(36545);let x=k("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),y=k("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),z=k("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),A=k("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),B=k("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),C=k("fingerprint-pattern",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]),D=k("delete",[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]]),E=k("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),F=k("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var G=a.i(88535);let H=()=>{let{loginAsStaff:a,loginAsAdmin:b}=(0,w.useAuth)(),[c,d]=(0,f.useState)("role-select"),[g,h]=(0,f.useState)([]),[i,j]=(0,f.useState)(null),[k,l]=(0,f.useState)(""),[n,o]=(0,f.useState)(""),[p,q]=(0,f.useState)(""),[r,s]=(0,f.useState)(!1),[u,v]=(0,f.useState)(""),[H,I]=(0,f.useState)(!1);(0,f.useEffect)(()=>{"staff-select"===c&&0===g.length&&(0,G.fetchStaffMembers)().then(a=>h(a)).catch(()=>v("Could not load staff list."))},[c]);let J=()=>{v(""),"staff-pin"===c?(d("staff-select"),l("")):("staff-select"===c||"admin-login"===c)&&(d("role-select"),l(""),o(""),q(""))},K=()=>{l(a=>a.slice(0,-1)),v("")},L=async b=>{if(!i)return;I(!0);let{error:c}=await a(i.id,i.name,b);c&&(v(c),l("")),I(!1)},M=async a=>{if(a.preventDefault(),!n||!p)return;v(""),I(!0);let{error:c}=await b(n,p);c&&v(c),I(!1)};return"role-select"===c?(0,e.jsx)("div",{className:"login-page",children:(0,e.jsxs)("div",{className:"login-container",children:[(0,e.jsxs)("div",{className:"login-brand animate-in",children:[(0,e.jsx)("div",{className:"login-logo",children:(0,e.jsx)("span",{className:"login-logo-icon",children:"ðŸ¢"})}),(0,e.jsx)("h1",{className:"login-title",children:"SocietyClean"}),(0,e.jsx)("p",{className:"login-subtitle",children:"Management Portal"})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-1",style:{display:"flex",flexDirection:"column",gap:16},children:[(0,e.jsxs)("button",{className:"login-role-card",onClick:()=>d("staff-select"),children:[(0,e.jsx)("div",{className:"login-role-icon",style:{background:"var(--green-light)"},children:(0,e.jsx)(m,{size:28,color:"#059669"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"login-role-title",children:"Staff Login"}),(0,e.jsx)("div",{className:"login-role-desc",children:"Select your profile & enter PIN"})]})]}),(0,e.jsxs)("button",{className:"login-role-card",onClick:()=>d("admin-login"),children:[(0,e.jsx)("div",{className:"login-role-icon",style:{background:"var(--blue-light)"},children:(0,e.jsx)(y,{size:28,color:"#2563eb"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"login-role-title",children:"Admin Login"}),(0,e.jsx)("div",{className:"login-role-desc",children:"Sign in to manage housekeeping"})]})]})]})]})}):"staff-select"===c?(0,e.jsx)("div",{className:"login-page",children:(0,e.jsxs)("div",{className:"login-container",style:{maxWidth:420},children:[(0,e.jsxs)("div",{className:"login-header animate-in",children:[(0,e.jsx)("button",{className:"login-back-btn",onClick:J,children:(0,e.jsx)(x,{size:20})}),(0,e.jsx)("span",{className:"login-header-title",children:"Staff Login"}),(0,e.jsx)("div",{style:{width:42}})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-1",style:{textAlign:"center",marginBottom:28},children:[(0,e.jsx)("div",{className:"login-hero-icon",style:{background:"var(--green-light)"},children:(0,e.jsx)(m,{size:32,color:"#059669"})}),(0,e.jsx)("h2",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:1,marginBottom:4},children:"Select Your Profile"}),(0,e.jsx)("p",{style:{fontSize:14,color:"var(--text-muted)",fontWeight:500},children:"Tap on your name to continue"})]}),u&&(0,e.jsx)("div",{className:"login-error",style:{marginBottom:16,textAlign:"center"},children:u}),(0,e.jsx)("div",{className:"staff-grid animate-in animate-in-delay-2",children:g.map(a=>(0,e.jsxs)("button",{className:"staff-card",onClick:()=>{j(a),l(""),v(""),d("staff-pin")},children:[(0,e.jsx)("div",{className:"staff-avatar-ring",children:(0,e.jsx)("img",{src:a.avatar,alt:a.name,className:"staff-avatar-img"})}),(0,e.jsx)("div",{className:"staff-card-name",children:a.name}),(0,e.jsx)("div",{className:"staff-card-info",children:a.blockAssignment})]},a.id))}),0===g.length&&!u&&(0,e.jsxs)("div",{style:{textAlign:"center",padding:40},children:[(0,e.jsx)(t,{size:28,className:"spin",style:{color:"var(--blue)"}}),(0,e.jsx)("div",{style:{marginTop:12,fontSize:13,color:"var(--text-muted)"},children:"Loading staff..."})]})]})}):"staff-pin"===c?(0,e.jsx)("div",{className:"login-page",children:(0,e.jsxs)("div",{className:"login-container",style:{maxWidth:380},children:[(0,e.jsxs)("div",{className:"login-header animate-in",children:[(0,e.jsx)("button",{className:"login-back-btn",onClick:J,children:(0,e.jsx)(x,{size:20})}),(0,e.jsx)("span",{className:"login-header-title",children:"Staff Login"}),(0,e.jsx)("div",{style:{width:42}})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-1",style:{textAlign:"center",marginBottom:24},children:[(0,e.jsx)("div",{className:"pin-avatar-ring",children:(0,e.jsx)("img",{src:i?.avatar,alt:i?.name,className:"pin-avatar-img"})}),(0,e.jsx)("h2",{style:{fontSize:22,fontWeight:800,color:"var(--text-primary)",marginBottom:2},children:i?.name}),(0,e.jsx)("button",{className:"pin-change-profile",onClick:J,children:"Tap to change profile"})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-2",style:{textAlign:"center",marginBottom:20},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,marginBottom:16},children:[(0,e.jsx)(C,{size:18,color:"var(--text-muted)"}),(0,e.jsx)("span",{style:{fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)"},children:"Enter PIN"})]}),(0,e.jsx)("div",{className:"pin-dots",children:[0,1,2,3].map(a=>(0,e.jsx)("div",{className:`pin-dot ${a<k.length?"filled":""}`},a))}),u&&(0,e.jsx)("div",{style:{fontSize:13,fontWeight:600,color:"var(--coral)",marginTop:8},children:u}),(0,e.jsx)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginTop:8},children:"Default PIN: 1234"})]}),(0,e.jsx)("div",{className:"pin-keypad animate-in animate-in-delay-3",children:["1","2","3","4","5","6","7","8","9","","0","del"].map((a,b)=>""===a?(0,e.jsx)("div",{className:"pin-key-spacer"},b):"del"===a?(0,e.jsx)("button",{className:"pin-key pin-key-del",onClick:K,children:(0,e.jsx)(D,{size:22})},b):(0,e.jsx)("button",{className:"pin-key",onClick:()=>(a=>{if(k.length>=4)return;let b=k+a;l(b),v(""),4===b.length&&i&&L(b)})(a),children:a},b))}),H&&(0,e.jsx)("div",{style:{textAlign:"center",marginTop:20},children:(0,e.jsx)(t,{size:28,className:"spin",style:{color:"var(--blue)"}})})]})}):(0,e.jsx)("div",{className:"login-page",children:(0,e.jsxs)("div",{className:"login-container",style:{maxWidth:380},children:[(0,e.jsxs)("div",{className:"login-header animate-in",children:[(0,e.jsx)("button",{className:"login-back-btn",onClick:J,children:(0,e.jsx)(x,{size:20})}),(0,e.jsx)("span",{className:"login-header-title",children:"Admin Login"}),(0,e.jsx)("div",{style:{width:42}})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-1",style:{textAlign:"center",marginBottom:32},children:[(0,e.jsx)("div",{className:"login-hero-icon login-hero-icon-lg",style:{background:"var(--blue-light)"},children:(0,e.jsx)(y,{size:36,color:"#2563eb"})}),(0,e.jsx)("h2",{style:{fontSize:24,fontWeight:800,color:"var(--text-primary)",marginBottom:4},children:"Admin Access"}),(0,e.jsx)("p",{style:{fontSize:14,color:"var(--text-muted)",fontWeight:500},children:"Sign in to manage your society housekeeping"})]}),(0,e.jsxs)("form",{onSubmit:M,className:"animate-in animate-in-delay-2",children:[(0,e.jsxs)("div",{className:"neu-input-group",style:{marginBottom:16},children:[(0,e.jsx)("label",{className:"neu-label",children:"Username"}),(0,e.jsxs)("div",{className:"neu-input-wrapper",children:[(0,e.jsx)(E,{size:18,style:{position:"absolute",left:14,color:"var(--text-muted)",zIndex:1}}),(0,e.jsx)("input",{type:"text",className:"neu-input",style:{paddingLeft:42},placeholder:"Enter username",value:n,onChange:a=>o(a.target.value),required:!0})]})]}),(0,e.jsxs)("div",{className:"neu-input-group",style:{marginBottom:12},children:[(0,e.jsx)("label",{className:"neu-label",children:"Password"}),(0,e.jsxs)("div",{className:"neu-input-wrapper",children:[(0,e.jsx)(F,{size:18,style:{position:"absolute",left:14,color:"var(--text-muted)",zIndex:1}}),(0,e.jsx)("input",{type:r?"text":"password",className:"neu-input",style:{paddingLeft:42},placeholder:"Enter password",value:p,onChange:a=>q(a.target.value),required:!0}),(0,e.jsx)("button",{type:"button",className:"neu-input-action",onClick:()=>s(!r),children:r?(0,e.jsx)(A,{size:16}):(0,e.jsx)(z,{size:16})})]})]}),(0,e.jsx)("div",{style:{textAlign:"center",marginBottom:20},children:(0,e.jsx)("span",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:"Default: admin / admin123"})}),u&&(0,e.jsx)("div",{className:"login-error",style:{marginBottom:16},children:u}),(0,e.jsx)("button",{type:"submit",className:"neu-btn-login",disabled:H,children:H?(0,e.jsx)(t,{size:20,className:"spin"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(B,{size:20})," Sign In"]})})]})]})})};(b={}).MANAGER="MANAGER",b.STAFF="STAFF";var I=((c={}).ROUTINE_HOUSEKEEPING="Routine Housekeeping",c.BROOMING="Brooming",c.MOPPING="Mopping",c.DRIVEWAY="Driveway Cleaning",c.GLASS_CLEANING="Glass Cleaning",c.STAIRCASE="Staircase Cleaning",c);(d={}).DAILY="Daily",d.WEEKLY="Weekly";let J=[1,2,3,4,5,6,7,8,9,10,11,12],K=a=>()=>a,L=[{block:1,label:"Block 1",flatsPerFloor:a=>a<=8?["A","B","C","D","E","F"]:["A","B","C"]},{block:2,label:"Block 2",flatsPerFloor:K(["A","B","C","D"])},{block:3,label:"Block 3",flatsPerFloor:K(["A","B","C","D","E"])},{block:4,label:"Block 4",flatsPerFloor:K(["A","B","C","D","E"])},{block:5,label:"Block 5",flatsPerFloor:K(["A","B","C","D","E"])},{block:6,label:"Block 6",flatsPerFloor:K(["A","B","C","D"])}],M=[{type:"Routine Housekeeping",label:"Routine Housekeeping",icon:"ðŸ—‘ï¸",perFlat:!0},{type:"Brooming",label:"Lobby Brooming",icon:"ðŸ§¹",perFlat:!1},{type:"Mopping",label:"Floor Mopping",icon:"ðŸ§¼",perFlat:!1},{type:"Staircase Cleaning",label:"Staircase Cleaning",icon:"ðŸªœ",perFlat:!1}],N=[{id:"glass-entrance",type:"Glass Cleaning",label:"Entrance Glass Cleaning",icon:"ðŸªŸ"}],O=[{id:"driveway-broom",type:"Driveway Cleaning",label:"Driveway Cleaning",icon:"ðŸš—",area:"Society Driveway"}],P=k("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Q=k("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),R=k("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),S=k("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),T=k("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),U=k("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var V=a.i(83160);let W=null;W=(0,V.createClient)("https://bhdrlzaqejkrqsozbcbr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJoZHJsemFxZWprcnFzb3piY2JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4NzM4OTAsImV4cCI6MjA4NTQ0OTg5MH0.W1kWS99fv-QjQI_eVE3XvPhMWbgMQoGqOtaUHcVlP9s");let X=async()=>{if(!W)return new Map;let a=new Date,b=a.toLocaleString("default",{month:"long"}),c=a.getFullYear(),d=`${b}_${c}`,{data:e,error:f}=await W.from("Collections_2026").select(`Flat_No, ${d}`);if(f)return console.error("Error fetching payment status:",f),new Map;let g=new Map;return e.forEach(a=>{let b=a.Flat_No?.trim();if(!b)return;let c=a[d],e=0===c||"0"===c||"string"==typeof c&&"N/A"===c.trim().toUpperCase();g.set(b,!e)}),g},Y=({percentage:a,size:b=160,strokeWidth:c=14})=>{let d=(b-c)/2,f=2*Math.PI*d;return(0,e.jsxs)("div",{className:"progress-ring-container",style:{width:b,height:b},children:[(0,e.jsxs)("svg",{width:b,height:b,style:{transform:"rotate(-90deg)"},children:[(0,e.jsx)("circle",{cx:b/2,cy:b/2,r:d,fill:"none",stroke:"var(--neu-dark)",strokeWidth:c}),(0,e.jsx)("circle",{cx:b/2,cy:b/2,r:d,fill:"none",stroke:"url(#gradient)",strokeWidth:c,strokeDasharray:f,strokeDashoffset:f-a/100*f,strokeLinecap:"round",style:{transition:"stroke-dashoffset 1s ease-out"}}),(0,e.jsx)("defs",{children:(0,e.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,e.jsx)("stop",{offset:"0%",stopColor:"#3b82f6"}),(0,e.jsx)("stop",{offset:"100%",stopColor:"#10b981"})]})})]}),(0,e.jsxs)("div",{style:{position:"absolute",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,e.jsx)("div",{style:{width:48,height:48,borderRadius:14,background:"var(--blue-light)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:6},children:(0,e.jsx)(S,{size:22,color:"#3b82f6"})}),(0,e.jsx)("span",{style:{fontSize:10,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:.5},children:"Live Feed"})]})]})},Z=({icon:a,title:b,desc:c,bgColor:d,onClick:f})=>(0,e.jsxs)("div",{className:"neu-card",onClick:f,style:{display:"flex",alignItems:"center",gap:14,padding:"18px 18px",cursor:"pointer"},children:[(0,e.jsx)("div",{style:{width:46,height:46,borderRadius:14,background:d,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,e.jsx)("span",{style:{fontSize:22},children:a})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:b}),(0,e.jsx)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:c})]})]}),$=({item:a,requester:b,time:c,onApprove:d,onReject:f})=>(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:12,padding:"16px 18px"},children:[(0,e.jsx)("div",{style:{width:42,height:42,borderRadius:14,background:"var(--green-light)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,e.jsx)("span",{style:{fontSize:18},children:"ðŸ“¦"})}),(0,e.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a}),(0,e.jsxs)("div",{style:{fontSize:11,fontWeight:500,color:"var(--text-muted)"},children:["Requested by ",b," Â· ",c]})]}),(0,e.jsxs)("div",{style:{display:"flex",gap:8,flexShrink:0},children:[(0,e.jsx)("button",{onClick:f,className:"btn-approve",style:{background:"var(--coral-light)",color:"var(--coral)"},children:(0,e.jsx)(Q,{size:14})}),(0,e.jsx)("button",{onClick:d,className:"btn-approve",style:{background:"var(--green-light)",color:"var(--green)"},children:(0,e.jsx)(P,{size:14})})]})]}),_=({logs:a,tasks:b,supplyRequests:c,onApproveSupply:d,onRejectSupply:g,staffMembers:h,punchLogs:i,onNavigate:j,onExport:k})=>{let[l,m]=f.default.useState(!1),[n,o]=f.default.useState(null),[p,q]=f.default.useState(""),[r,s]=f.default.useState(!1),[t,u]=f.default.useState({name:"",role:"Housekeeper",blockAssignment:"",avatar:""}),[v,w]=f.default.useState(!1),[x,y]=f.default.useState(new Map),[z,A]=f.default.useState(!0),B=new Date().setHours(0,0,0,0),C=a.filter(a=>a.timestamp>=B);f.default.useEffect(()=>{X().then(a=>{y(a),A(!1)})},[]);let D=f.default.useMemo(()=>{let a;return z?0:(a=0+O.length,L.forEach(b=>{a+=N.length,J.forEach(c=>{let d=b.flatsPerFloor(c).filter(a=>{let d=`${b.block}${a}${c}`;return x.has(d)&&!0===x.get(d)});a+=M.filter(a=>a.perFlat).length*d.length,a+=M.filter(a=>!a.perFlat).length})}),a)},[z,x]),E=C.filter(a=>{if("COMPLETED"!==a.status)return!1;if(a.flat&&a.block&&a.floor){let b=`${a.block}${a.flat}${a.floor}`;if(!z&&x.size>0)return!0===x.get(b)}return!0}).length,F=D>0?Math.round(E/D*100):0,H=f.default.useMemo(()=>{if(z)return{garbage:{done:0,total:0},brooming:{done:0,total:0}};let a=0,b=0;L.forEach(c=>{J.forEach(d=>{let e=c.flatsPerFloor(d).filter(a=>{let b=`${c.block}${a}${d}`;return x.has(b)&&!0===x.get(b)});a+=e.length,M.some(a=>a.type===I.BROOMING)&&(b+=1)})});let c=C.filter(a=>{if("COMPLETED"!==a.status||!(a.taskId===I.ROUTINE_HOUSEKEEPING||a.taskId.includes("Routine")||a.taskId.includes("Garbage")))return!1;if(a.flat&&a.block&&a.floor){let b=`${a.block}${a.flat}${a.floor}`;return!0===x.get(b)}return!1}).length,d=C.filter(a=>"COMPLETED"===a.status&&(a.taskId===I.BROOMING||a.taskId.includes("Brooming"))).length;return{garbage:{done:c,total:a},brooming:{done:d,total:b}}},[z,x,C]),K=H.garbage.total>0?Math.round(H.garbage.done/H.garbage.total*100):0,P=H.brooming.total>0?Math.round(H.brooming.done/H.brooming.total*100):0,S=c.filter(a=>"OPEN"===a.status),V=async()=>{if(!t.name||!t.blockAssignment)return void alert("Name and Block Assignment are required");w(!0);try{await (0,G.insertStaffMember)({name:t.name,role:"Housekeeper",avatar:t.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=random`,blockAssignment:t.blockAssignment}),m(!1),q(""),s(!1),u({name:"",role:"Housekeeper",blockAssignment:"",avatar:""}),alert("Staff added successfully!")}catch(a){alert("Failed to add staff: "+a.message)}finally{w(!1)}};return(0,e.jsxs)("div",{style:{paddingBottom:16},children:[l&&(0,e.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)("div",{className:"neu-card",style:{width:320,padding:24,background:"var(--bg-card)"},children:r?(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,e.jsx)("h3",{style:{margin:0},children:"Add New Staff"}),(0,e.jsx)("input",{placeholder:"Staff Name",value:t.name,onChange:a=>u({...t,name:a.target.value}),style:{padding:12,borderRadius:8,border:"none",background:"var(--bg-inset)",color:"var(--text-primary)"}}),(0,e.jsx)("input",{placeholder:"Block Assignment (e.g., Block 1)",value:t.blockAssignment,onChange:a=>u({...t,blockAssignment:a.target.value}),style:{padding:12,borderRadius:8,border:"none",background:"var(--bg-inset)",color:"var(--text-primary)"}}),(0,e.jsxs)("div",{style:{display:"flex",gap:10,marginTop:8},children:[(0,e.jsx)("button",{onClick:()=>m(!1),className:"btn-ghost",style:{flex:1},children:"Cancel"}),(0,e.jsx)("button",{onClick:V,className:"neu-button",disabled:v,style:{flex:1,color:"white",background:"var(--green)"},children:v?"Saving...":"Save"})]})]}):(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,e.jsx)("h3",{style:{margin:0,textAlign:"center"},children:"Admin Access"}),(0,e.jsx)("input",{type:"password",placeholder:"Enter Credential PIN",value:p,onChange:a=>q(a.target.value),style:{padding:12,borderRadius:8,border:"1px solid var(--text-muted)",background:"var(--bg-inset)",color:"var(--text-primary)",outline:"none"}}),(0,e.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,e.jsx)("button",{onClick:()=>m(!1),className:"btn-ghost",style:{flex:1},children:"Cancel"}),(0,e.jsx)("button",{onClick:()=>{"1234"===p?s(!0):alert("Invalid Credential")},className:"neu-button",style:{flex:1,color:"white",background:"var(--blue)"},children:"Verify"})]})]})})}),n&&(0,e.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>o(null),children:(0,e.jsxs)("div",{className:"neu-card",style:{width:300,padding:24,background:"var(--bg-card)",position:"relative"},onClick:a=>a.stopPropagation(),children:[(0,e.jsx)("button",{onClick:()=>o(null),style:{position:"absolute",top:12,right:12,background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:(0,e.jsx)(Q,{size:20})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:20},children:[(0,e.jsx)("img",{src:n.avatar,alt:n.name,className:"avatar",style:{width:80,height:80,marginBottom:12}}),(0,e.jsx)("h3",{style:{margin:0,fontSize:18},children:n.name}),(0,e.jsx)("span",{style:{fontSize:13,color:"var(--text-muted)"},children:n.role})]}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",background:"var(--bg-inset)",borderRadius:8},children:[(0,e.jsx)("span",{style:{fontSize:13,fontWeight:600},children:"Block Assignment"}),(0,e.jsx)("span",{style:{fontSize:13},children:n.blockAssignment})]}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",background:"var(--bg-inset)",borderRadius:8},children:[(0,e.jsx)("span",{style:{fontSize:13,fontWeight:600},children:"Tasks Today"}),(0,e.jsx)("span",{style:{fontSize:13},children:a.filter(a=>a.staffId===n.id&&a.timestamp>=B&&"COMPLETED"===a.status).length})]})]}),(0,e.jsx)("div",{style:{marginTop:20,textAlign:"center"},children:(0,e.jsx)("button",{className:"neu-button",style:{width:"100%"},onClick:()=>o(null),children:"Close"})})]})}),(0,e.jsxs)("div",{className:"animate-in",style:{marginBottom:24},children:[(0,e.jsxs)("div",{className:"section-header",children:[(0,e.jsx)("span",{className:"section-title",children:"On-Duty Staff"}),(0,e.jsx)("button",{className:"btn-ghost",style:{fontSize:13,fontWeight:600,color:"var(--blue)",padding:"4px 8px"},children:"View All"})]}),(0,e.jsx)("div",{style:{display:"flex",gap:20,overflowX:"auto",paddingBottom:4},className:"no-scrollbar",children:(0,e.jsx)("div",{style:{display:"flex",gap:20,overflowX:"auto",paddingBottom:4},className:"no-scrollbar",children:0===h.filter(a=>{let b=i.filter(b=>b.staffId===a.id&&b.timestamp>=B).sort((a,b)=>b.timestamp-a.timestamp);return b.length>0&&"IN"===b[0].type}).length?(0,e.jsx)("div",{style:{padding:"0 8px",fontSize:13,color:"var(--text-muted)",fontStyle:"italic"},children:"No staff currently on duty."}):(0,e.jsxs)(e.Fragment,{children:[h.map(a=>{let b=i.filter(b=>b.staffId===a.id&&b.timestamp>=B).sort((a,b)=>b.timestamp-a.timestamp);if(!(b.length>0&&"IN"===b[0].type))return null;let c=C.filter(b=>b.staffId===a.id&&"COMPLETED"===b.status).length;return(0,e.jsxs)("div",{onClick:()=>o(a),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6,minWidth:72,cursor:"pointer"},children:[(0,e.jsx)("img",{src:a.avatar,alt:a.name,className:"avatar avatar-lg",style:{width:56,height:56}}),(0,e.jsxs)("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",textAlign:"center",lineHeight:1.2},children:[a.name.split(" ")[0]," ",a.name.split(" ")[1]?.[0],"."]}),(0,e.jsxs)("span",{style:{fontSize:10,fontWeight:500,color:"var(--green)"},children:[c," tasks today"]})]},a.id)}),(0,e.jsxs)("button",{onClick:()=>m(!0),style:{minWidth:72,height:90,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:6,background:"transparent",border:"none",cursor:"pointer"},children:[(0,e.jsx)("div",{style:{width:56,height:56,borderRadius:"50%",background:"var(--bg-inset)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",border:"1px dashed var(--text-muted)"},children:(0,e.jsx)(U,{size:24})}),(0,e.jsx)("span",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)"},children:"Add New"})]})]})})})]}),(0,e.jsxs)("div",{className:"neu-card-inset animate-in animate-in-delay-1",style:{marginBottom:24,textAlign:"center",padding:24},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[(0,e.jsx)("span",{className:"section-title",children:"Daily Progress"}),(0,e.jsxs)("div",{style:{textAlign:"right"},children:[(0,e.jsxs)("div",{style:{fontSize:28,fontWeight:800,color:"var(--text-primary)",lineHeight:1},children:[F,"%"]}),(0,e.jsx)("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:.5},children:"Average"})]})]}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:16},children:(0,e.jsx)(Y,{percentage:F})}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:24},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"var(--green)"}}),(0,e.jsxs)("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)"},children:["Garbage: ",K,"%"]})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"var(--blue)"}}),(0,e.jsxs)("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)"},children:["Brooming: ",P,"%"]})]})]})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-2",style:{marginBottom:24},children:[(0,e.jsxs)("div",{className:"section-header",children:[(0,e.jsx)("span",{className:"section-title",children:"Supplies Status"}),S.length>0&&(0,e.jsxs)("span",{className:"badge badge-green",children:[S.length," New Requests"]})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:0===S.length?(0,e.jsx)("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:13,background:"var(--bg-inset)",borderRadius:12},children:"No pending supply requests."}):S.map(a=>{let b=h.find(b=>b.id===a.requesterId),c=Math.round((Date.now()-a.timestamp)/6e4);return(0,e.jsx)($,{item:`${a.item} (${a.quantity})`,requester:b?.name.split(" ")[0]||"Staff",time:`${c}m ago`,onApprove:()=>d(a.id),onReject:()=>g(a.id)},a.id)})})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-3",style:{marginBottom:24},children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Zone Monitoring"})}),(0,e.jsx)("div",{className:"neu-card",style:{padding:0,overflow:"hidden",position:"relative",height:180},children:(0,e.jsxs)("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, var(--blue-bg) 0%, var(--green-bg) 50%, var(--yellow-bg) 100%)",display:"flex",alignItems:"flex-end",justifyContent:"space-between",padding:16,position:"relative"},children:[(0,e.jsx)("div",{style:{position:"absolute",top:40,left:"30%",width:12,height:12,borderRadius:"50%",background:C.some(a=>1===a.block)?"var(--green)":"var(--red)",boxShadow:"0 0 0 4px rgba(255,255,255,0.2)"}}),(0,e.jsx)("div",{style:{position:"absolute",top:70,left:"50%",width:12,height:12,borderRadius:"50%",background:C.some(a=>2===a.block)?"var(--green)":"var(--red)",boxShadow:"0 0 0 4px rgba(255,255,255,0.2)"}}),(0,e.jsx)("div",{style:{position:"absolute",top:55,left:"65%",width:12,height:12,borderRadius:"50%",background:C.some(a=>3===a.block)?"var(--green)":"var(--red)",boxShadow:"0 0 0 4px rgba(255,255,255,0.2)"}}),(0,e.jsx)("div",{style:{position:"absolute",top:90,left:"40%",width:12,height:12,borderRadius:"50%",background:C.some(a=>4===a.block)?"var(--green)":"var(--red)",boxShadow:"0 0 0 4px rgba(255,255,255,0.2)"}}),(0,e.jsxs)("div",{style:{background:"rgba(255,255,255,0.85)",borderRadius:10,padding:"8px 14px",fontSize:11,fontWeight:700,color:"var(--text-secondary)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",gap:4,boxShadow:"var(--neu-raised-sm)"},children:[(0,e.jsx)(R,{size:12})," Live Zone Coverage"]}),(0,e.jsx)("button",{style:{width:46,height:46,borderRadius:"50%",background:"var(--blue)",color:"white",border:"none",cursor:"pointer",fontSize:22,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 14px rgba(59,130,246,0.4)"},children:"+"})]})})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-4",style:{marginBottom:20},children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Management Hub"})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[(0,e.jsx)(Z,{icon:"ðŸ‘¤",title:"Manage Staff",desc:"Add, edit profiles & schedules",color:"var(--purple)",bgColor:"var(--purple-light)",onClick:()=>j("STAFF")}),(0,e.jsx)(Z,{icon:"ðŸ“¦",title:"Inventory Management",desc:"Restock alerts & tracking",color:"var(--coral)",bgColor:"var(--coral-light)",onClick:()=>j("STOCK")}),(0,e.jsx)(Z,{icon:"ðŸ“‹",title:"System Logs",desc:"View all system activities",color:"var(--green)",bgColor:"var(--green-light)",onClick:()=>j("LOGS")}),(0,e.jsxs)("button",{className:"neu-card",onClick:k,style:{textAlign:"center",padding:"18px 16px",cursor:"pointer",width:"100%",fontSize:15,fontWeight:700,color:"var(--text-primary)",fontFamily:"inherit",borderRadius:"var(--radius)",border:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:10},children:[(0,e.jsx)(T,{size:18})," Export Monthly Report"]})]})]})]})},aa=k("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),ab=k("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ac=k("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]),ad=async(a,b="societyclean/proof-of-work")=>{let c=a.startsWith("data:")?a:`data:image/jpeg;base64,${a}`,d=new FormData;d.append("file",c),d.append("upload_preset","ml_default"),d.append("folder",b);let e=await fetch("https://api.cloudinary.com/v1_1/demodqx39/image/upload",{method:"POST",body:d});if(!e.ok){let a=await e.text();throw Error(`Cloudinary upload failed (${e.status}): ${a}`)}let f=await e.json();return{secure_url:f.secure_url,public_id:f.public_id,width:f.width,height:f.height,format:f.format,created_at:f.created_at}};async function ae(a,b){return new Promise((c,d)=>{let e=new Image;e.onload=()=>{let d=document.createElement("canvas");d.width=e.width,d.height=e.height;let f=d.getContext("2d");if(!f)return void c(a);f.drawImage(e,0,0);let g=new Date,h=g.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),i=g.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),j=`${h}  ${i}`,k=Math.max(14,Math.round(.035*e.width));f.font=`bold ${k}px 'Arial', sans-serif`;let l=Math.round(.5*k),m=Math.round(1.2*k),n=f.measureText(j).width;b&&(n=Math.max(n,f.measureText(b).width));let o=b?2*m:m,p=e.width-n-2*l,q=e.height-o-2*l;f.fillStyle="rgba(0, 0, 0, 0.6)",f.beginPath(),f.roundRect(p-l,q-l,n+2*l,o+2*l,6),f.fill(),f.fillStyle="#ffffff",f.textBaseline="top",b?(f.fillText(b,p,q),f.fillText(j,p,q+m)):f.fillText(j,p,q),c(d.toDataURL("image/jpeg",.9))},e.onerror=()=>c(a),e.src=a})}let af=({currentUser:a,logs:b,onLogTask:c,staffMembers:d})=>{let g,[h,i]=(0,f.useState)("blocks"),[j,k]=(0,f.useState)(null),[l,m]=(0,f.useState)(null),[n,o]=(0,f.useState)(!1),[p,q]=(0,f.useState)(null),[r,s]=(0,f.useState)(null),[u,v]=(0,f.useState)(!1),w=(0,f.useRef)(null),y=(0,f.useRef)(null),z=(0,f.useRef)(null),[A,B]=(0,f.useState)(new Map),[C,D]=(0,f.useState)(!0);(0,f.useEffect)(()=>{X().then(a=>{B(a),D(!1)})},[]);let E=d.find(b=>b.id===a),F=new Date().setHours(0,0,0,0),G=b.filter(a=>a.timestamp>=F),H=(a,b,c,d)=>G.some(e=>e.block===a&&e.floor===b&&e.taskId===c&&(d?e.flat===d:!e.flat)),I=(a,b)=>G.some(c=>c.taskId===a&&c.block===b),K=()=>{"tasks"===h?(i("floors"),m(null)):"floors"===h&&(i("blocks"),k(null))},R=async(a,b,c,d)=>{s({taskId:a,taskType:b,flat:c,block:d}),v(!0);try{let a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1});y.current=a,setTimeout(()=>{w.current&&(w.current.srcObject=a,w.current.play())},100)}catch(a){console.error("Camera error:",a),alert("Unable to access camera. Please ensure you have granted camera permissions and are using HTTPS or localhost."),v(!1),s(null)}},S=(0,f.useCallback)(()=>{y.current&&(y.current.getTracks().forEach(a=>a.stop()),y.current=null),v(!1)},[]),T=async()=>{if(!w.current||!z.current||!r)return;let b=w.current,d=z.current;d.width=b.videoWidth,d.height=b.videoHeight;let e=d.getContext("2d");if(!e)return;e.drawImage(b,0,0),S();let f=d.toDataURL("image/jpeg",.85);q(`${r.taskType}-${r.flat||"area"}`),o(!0);let g=f;try{let a="";if(r.flat&&j)a=`Block ${j.block} - Flat ${r.flat} (Floor ${l})`;else if(l&&j)a=`Block ${j.block} - Floor ${l}`;else if(r.block)a=`Block ${r.block}`;else{let b=O.find(a=>a.id===r.taskId);a=b?b.area:"Common Area"}let b=await ae(f,a),c=E?.name.replace(/\s+/g,"_")||"unknown",d=j?`B${j.block}`:"Common",e=l?`/F${l}`:"",h=`societyclean/${d}${e}/${c}`;g=(await ad(b,h)).secure_url}catch{}c({taskId:r.taskId,staffId:a,timestamp:Date.now(),status:"COMPLETED",imageUrl:g,block:r.block||(j?j.block:void 0),floor:l||void 0,flat:r.flat||void 0}),o(!1),q(null),s(null)};return(0,e.jsxs)("div",{style:{paddingBottom:16},children:["blocks"===h&&(g=G.length,(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"neu-card animate-in",style:{marginBottom:22,padding:20,display:"flex",alignItems:"center",gap:16},children:[(0,e.jsx)("div",{style:{width:54,height:54,borderRadius:"50%",background:"linear-gradient(135deg, var(--blue), var(--purple))",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:16,fontWeight:800,flexShrink:0,boxShadow:"0 4px 14px rgba(99, 102, 241, 0.3)"},children:g}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:16,fontWeight:700,color:"var(--text-primary)"},children:E?`Hi, ${E.name}`:"My Tasks"}),(0,e.jsxs)("div",{style:{fontSize:13,fontWeight:500,color:"var(--text-secondary)"},children:[g," tasks completed today"]})]})]}),(0,e.jsxs)("div",{className:"section-header animate-in animate-in-delay-1",children:[(0,e.jsx)("span",{style:{fontSize:17,fontWeight:700,color:"var(--text-primary)"},children:"Select Block"}),(0,e.jsx)("span",{className:"section-label",children:"6 BLOCKS"})]}),(0,e.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:24},className:"animate-in animate-in-delay-1",children:L.map((a,b)=>{let{done:c,total:d}=(a=>{let b=L.find(b=>b.block===a);if(!b)return{done:0,total:0};let c=0,d=0;return J.forEach(e=>{let f=b.flatsPerFloor(e),g=M.filter(a=>a.perFlat);c+=g.length*f.length,d+=g.reduce((b,c)=>b+f.filter(b=>H(a,e,c.type,b)).length,0);let h=M.filter(a=>!a.perFlat);c+=h.length,d+=h.filter(b=>H(a,e,b.type)).length}),c+=N.length,{done:d+=N.filter(b=>I(b.id,a)).length,total:c}})(a.block),f=d>0?Math.round(c/d*100):0;return(0,e.jsxs)("button",{onClick:()=>{k(a),i("floors")},className:"neu-card",style:{cursor:"pointer",textAlign:"center",padding:22,display:"flex",flexDirection:"column",alignItems:"center",gap:10,border:"none",fontFamily:"inherit",transition:"all 0.2s ease",animationDelay:`${60*b}ms`},children:[(0,e.jsx)("div",{style:{width:52,height:52,borderRadius:16,background:100===f?"linear-gradient(135deg, #10b981, #059669)":`linear-gradient(135deg, ${["#6366f1","#3b82f6","#f97316","#06b6d4","#8b5cf6","#ec4899"][b]}, ${["#818cf8","#60a5fa","#fb923c","#22d3ee","#a78bfa","#f472b6"][b]})`,display:"flex",alignItems:"center",justifyContent:"center",color:"white",boxShadow:`0 4px 14px ${["rgba(99,102,241,0.3)","rgba(59,130,246,0.3)","rgba(249,115,22,0.3)","rgba(6,182,212,0.3)","rgba(139,92,246,0.3)","rgba(236,72,153,0.3)"][b]}`},children:(0,e.jsx)(ac,{size:24})}),(0,e.jsxs)("span",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:["Block ",a.block]}),(0,e.jsxs)("div",{style:{fontSize:11,fontWeight:600,color:100===f?"var(--green)":"var(--text-muted)"},children:[c,"/",d," done"]}),(0,e.jsx)("div",{style:{width:"100%",height:4,borderRadius:2,background:"var(--bg-inset)",overflow:"hidden"},children:(0,e.jsx)("div",{style:{width:`${f}%`,height:"100%",borderRadius:2,background:100===f?"var(--green)":"var(--blue)",transition:"width 0.3s"}})})]},a.block)})}),(0,e.jsxs)("div",{className:"section-header animate-in animate-in-delay-2",children:[(0,e.jsx)("span",{style:{fontSize:17,fontWeight:700,color:"var(--text-primary)"},children:"Common Areas"}),(0,e.jsx)("span",{className:"section-label",children:"DAILY"})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},className:"animate-in animate-in-delay-2",children:O.map(a=>{let b,c=(b=a.id,G.some(a=>a.taskId===b));return(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 18px"},children:[(0,e.jsx)("span",{style:{fontSize:22},children:a.icon}),(0,e.jsxs)("div",{style:{flex:1},children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:a.label}),(0,e.jsx)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:a.area})]}),c?(0,e.jsx)("div",{className:"check-circle done",children:(0,e.jsx)(P,{size:14})}):(0,e.jsxs)("button",{onClick:()=>R(a.id,a.type),style:{background:"var(--blue)",color:"white",border:"none",borderRadius:10,padding:"8px 14px",fontSize:12,fontWeight:700,cursor:"pointer",fontFamily:"inherit",display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(aa,{size:14})," Capture"]})]},a.id)})})]})),"floors"===h&&(j?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},className:"animate-in",children:[(0,e.jsx)("button",{onClick:K,className:"btn-icon",style:{flexShrink:0},children:(0,e.jsx)(x,{size:20})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)"},children:j.label}),(0,e.jsx)("div",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)"},children:"Select Floor"})]})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:J.map((a,b)=>{let c=j.flatsPerFloor(a).filter(b=>{let c=`${j.block}${b}${a}`;return A.has(c)&&!0===A.get(c)}),d=0,f=0;if(c.length>0){let b=M.filter(a=>a.perFlat);d+=b.length*c.length,f+=b.reduce((b,d)=>b+c.filter(b=>H(j.block,a,d.type,b)).length,0);let e=M.filter(a=>!a.perFlat);d+=e.length,f+=e.filter(b=>H(j.block,a,b.type)).length}let g=!C&&0===c.length,h=!C&&c.length>0&&f===d,k=d>0?Math.round(f/d*100):0;return(0,e.jsxs)("button",{onClick:()=>{m(a),i("tasks")},className:"neu-card animate-in",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 18px",cursor:"pointer",textAlign:"left",width:"100%",border:"none",fontFamily:"inherit",transition:"all 0.2s ease",animationDelay:`${40*b}ms`,opacity:h?.7:1,...g?{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--red)"}:{}},children:[(0,e.jsx)("div",{style:{width:42,height:42,borderRadius:12,flexShrink:0,background:h?"var(--green-light)":g?"var(--red)":"var(--bg-inset)",display:"flex",alignItems:"center",justifyContent:"center",color:h?"var(--green)":g?"white":"var(--text-muted)",fontWeight:800,fontSize:16},children:g?(0,e.jsx)(Q,{size:20}):a}),(0,e.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,e.jsxs)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:["Floor ",a]}),(0,e.jsx)("div",{style:{fontSize:12,fontWeight:500,color:g?"var(--red)":"var(--text-muted)"},children:g?"No serviceable flats":`${c.length} flats \xb7 ${f}/${d} tasks`})]}),(0,e.jsx)("div",{style:{width:44,textAlign:"right"},children:h?(0,e.jsx)("div",{className:"check-circle done",children:(0,e.jsx)(P,{size:14})}):g?(0,e.jsx)("span",{style:{fontSize:11,fontWeight:700,color:"var(--red)"},children:"LOCKED"}):(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,color:"var(--text-muted)"},children:[(0,e.jsx)("span",{style:{fontSize:12,fontWeight:700},children:C?"...":`${k}%`}),(0,e.jsx)(ab,{size:16})]})})]},a)})}),(0,e.jsxs)("div",{className:"section-header animate-in animate-in-delay-1",style:{marginTop:20},children:[(0,e.jsx)("span",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:"Block Tasks"}),(0,e.jsx)("span",{className:"section-label",children:"DAILY"})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10},className:"animate-in animate-in-delay-2",children:N.map(a=>{let b=I(a.id,j.block);return(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 18px"},children:[(0,e.jsx)("span",{style:{fontSize:22},children:a.icon}),(0,e.jsxs)("div",{style:{flex:1},children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:a.label}),(0,e.jsxs)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:[j.label," Entrance"]})]}),b?(0,e.jsx)("div",{className:"check-circle done",children:(0,e.jsx)(P,{size:14})}):(0,e.jsxs)("button",{onClick:()=>R(a.id,a.type,void 0,j.block),style:{background:"var(--blue)",color:"white",border:"none",borderRadius:10,padding:"8px 14px",fontSize:12,fontWeight:700,cursor:"pointer",fontFamily:"inherit",display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(aa,{size:14})," Capture"]})]},a.id)})})]}):null),"tasks"===h&&(()=>{if(!j||!l)return null;let a=j.flatsPerFloor(l);return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},className:"animate-in",children:[(0,e.jsx)("button",{onClick:K,className:"btn-icon",style:{flexShrink:0},children:(0,e.jsx)(x,{size:20})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)"},children:[j.label," Â· Floor ",l]}),(0,e.jsx)("div",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)"},children:"Floor Tasks"})]})]}),M.filter(a=>a.perFlat).map(b=>(0,e.jsxs)("div",{className:"animate-in animate-in-delay-1",style:{marginBottom:22},children:[(0,e.jsxs)("div",{className:"section-header",children:[(0,e.jsxs)("span",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:[b.icon," ",b.label]}),(0,e.jsxs)("span",{className:"section-label",children:[a.length," FLATS"]})]}),(0,e.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${Math.min(a.length,4)}, 1fr)`,gap:10},children:a.map(a=>{let c=H(j.block,l,b.type,a),d=`${j.block}${a}${l}`,f=A.has(d),g=!!f&&A.get(d),h=f&&!g,i=!f,k=p===`${b.type}-${a}`;return(0,e.jsxs)("button",{onClick:()=>{c||k||h||i||R(b.type,b.type,a,j.block)},disabled:c||k||h||i,className:c?"neu-card":"neu-card-inset",style:{padding:"14px 8px",border:h?"1px solid var(--red)":i?"1px dashed var(--text-muted)":"none",fontFamily:"inherit",cursor:c||h||i?"default":"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:6,opacity:c||h||i?.7:1,transition:"all 0.2s",background:c?"var(--green-light)":h?"rgba(239, 68, 68, 0.1)":i?"rgba(0,0,0,0.05)":void 0},children:[k?(0,e.jsx)(t,{size:20,className:"spin",style:{color:"var(--blue)"}}):c?(0,e.jsx)(P,{size:20,style:{color:"var(--green)"}}):h?(0,e.jsx)(Q,{size:20,style:{color:"var(--red)"}}):i?(0,e.jsx)("div",{style:{width:18,height:18}}):(0,e.jsx)(aa,{size:18,style:{color:"var(--text-muted)"}}),(0,e.jsx)("span",{style:{fontSize:13,fontWeight:700,color:c?"var(--green)":h?"var(--red)":i?"var(--text-muted)":"var(--text-primary)"},children:a}),(0,e.jsx)("span",{style:{fontSize:10,fontWeight:600,color:h?"var(--red)":"var(--text-muted)"},children:c?"Done":h?"Unpaid":i?"N/A":"Tap"})]},a)})})]},b.type)),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-2",style:{marginBottom:22},children:[(0,e.jsxs)("div",{className:"section-header",children:[(0,e.jsx)("span",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:"Area Tasks"}),(0,e.jsx)("span",{className:"section-label",children:"LOBBY & STAIRCASE"})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:M.filter(a=>!a.perFlat).map(a=>{let b=H(j.block,l,a.type),c=`${a.type}-area`;return(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 18px"},children:[(0,e.jsx)("span",{style:{fontSize:22},children:a.icon}),(0,e.jsxs)("div",{style:{flex:1},children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:a.label}),(0,e.jsxs)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:[j.label," Â· Floor ",l]})]}),b?(0,e.jsx)("div",{className:"check-circle done",children:(0,e.jsx)(P,{size:14})}):p===c?(0,e.jsx)(t,{size:20,className:"spin",style:{color:"var(--blue)"}}):(0,e.jsxs)("button",{onClick:()=>R(a.type,a.type,void 0,j.block),className:"btn-primary",style:{background:"var(--blue)",color:"white",border:"none",borderRadius:10,padding:"8px 16px",fontSize:13,fontWeight:700,cursor:"pointer",fontFamily:"inherit",display:"flex",alignItems:"center",gap:8},children:[(0,e.jsx)(aa,{size:16})," Capture Proof"]})]},a.type)})})]})]})})(),u?(0,e.jsxs)("div",{style:{position:"fixed",inset:0,zIndex:9999,background:"#000",display:"flex",flexDirection:"column"},children:[(0,e.jsx)("video",{ref:w,autoPlay:!0,playsInline:!0,muted:!0,style:{flex:1,width:"100%",objectFit:"cover"}}),(0,e.jsx)("canvas",{ref:z,style:{display:"none"}}),(0,e.jsxs)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"24px 0 40px",display:"flex",justifyContent:"center",alignItems:"center",background:"linear-gradient(transparent, rgba(0,0,0,0.8))"},children:[(0,e.jsx)("button",{onClick:()=>{S(),s(null)},style:{position:"absolute",left:24,top:24,background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"50%",width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",backdropFilter:"blur(8px)"},children:(0,e.jsx)(Q,{size:22,style:{color:"white"}})}),(0,e.jsx)("button",{onClick:T,style:{width:72,height:72,borderRadius:"50%",background:"white",border:"4px solid rgba(255,255,255,0.4)",cursor:"pointer",boxShadow:"0 0 20px rgba(255,255,255,0.3)",transition:"transform 0.1s"},onPointerDown:a=>a.currentTarget.style.transform="scale(0.9)",onPointerUp:a=>a.currentTarget.style.transform="scale(1)"})]}),(0,e.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,padding:"48px 20px 16px",background:"linear-gradient(rgba(0,0,0,0.7), transparent)",textAlign:"center"},children:[(0,e.jsxs)("div",{style:{color:"white",fontSize:14,fontWeight:700},children:["ðŸ“¸ ",r?.flat?`Flat ${r.flat}`:"Area"," â€” ",r?.taskType]}),(0,e.jsx)("div",{style:{color:"rgba(255,255,255,0.6)",fontSize:12,marginTop:4},children:"Take a live photo as proof of work"})]})]}):null]})},ag=k("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),ah=["Floor Cleaner Liquid","Garbage Bags (Large)","Heavy Broom","Glass Detergent","Mop Refills","Disinfectant Spray"],ai=({currentUser:a,requests:b,onRequest:c,staffMembers:d,isManagerView:g=!1})=>{let[h,i]=(0,f.useState)(""),[j,k]=(0,f.useState)(""),[l,m]=(0,f.useState)("LOW");return(0,e.jsxs)("div",{style:{paddingBottom:16},children:[(0,e.jsxs)("div",{className:"animate-in",style:{marginBottom:20},children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Quick Request"})}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:ah.map(a=>(0,e.jsx)("button",{onClick:()=>i(a),style:{padding:"8px 14px",borderRadius:20,fontSize:12,fontWeight:600,border:"none",cursor:"pointer",fontFamily:"inherit",background:h===a?"var(--green-light)":"var(--bg-card)",color:h===a?"#059669":"var(--text-secondary)",boxShadow:h===a?"var(--neu-inset-sm)":"var(--neu-raised-sm)",transition:"all 0.2s"},children:a},a))})]}),!g&&(0,e.jsx)("form",{onSubmit:b=>{b.preventDefault(),h&&j&&(c({item:h,quantity:j,urgency:l,status:"OPEN",requesterId:a,timestamp:Date.now()}),i(""),k(""),m("LOW"))},children:(0,e.jsxs)("div",{className:"neu-card animate-in animate-in-delay-1",style:{marginBottom:20,padding:22},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:18,paddingBottom:14,borderBottom:"1px solid var(--neu-dark)"},children:[(0,e.jsx)("div",{style:{width:38,height:38,borderRadius:12,background:"var(--coral)",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:(0,e.jsx)(n,{size:16})}),(0,e.jsx)("span",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)"},children:"New Request"})]}),(0,e.jsxs)("div",{className:"neu-input-group",style:{marginBottom:14},children:[(0,e.jsx)("label",{className:"neu-label",children:"Item Name"}),(0,e.jsx)("div",{className:"neu-input-wrapper",children:(0,e.jsx)("input",{type:"text",className:"neu-input",value:h,onChange:a=>i(a.target.value),placeholder:"e.g. Floor Cleaner Liquid"})})]}),(0,e.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:18},children:[(0,e.jsxs)("div",{className:"neu-input-group",style:{flex:1},children:[(0,e.jsx)("label",{className:"neu-label",children:"Quantity"}),(0,e.jsx)("div",{className:"neu-input-wrapper",children:(0,e.jsx)("input",{type:"text",className:"neu-input",value:j,onChange:a=>k(a.target.value),placeholder:"e.g. 5 Liters"})})]}),(0,e.jsxs)("div",{className:"neu-input-group",style:{width:110},children:[(0,e.jsx)("label",{className:"neu-label",children:"Urgency"}),(0,e.jsx)("div",{className:"neu-input-wrapper",children:(0,e.jsxs)("select",{value:l,onChange:a=>m(a.target.value),className:"neu-input",style:{cursor:"pointer",appearance:"none"},children:[(0,e.jsx)("option",{value:"LOW",children:"Low"}),(0,e.jsx)("option",{value:"MEDIUM",children:"Med"}),(0,e.jsx)("option",{value:"HIGH",children:"High"})]})})]})]}),(0,e.jsxs)("button",{type:"submit",disabled:!h||!j,className:"btn btn-coral",style:{width:"100%",padding:"14px",fontSize:14,fontWeight:700,borderRadius:14,opacity:h&&j?1:.5,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[(0,e.jsx)(ag,{size:16})," Submit Request"]})]})}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-2",children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Recent Requests"})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[b.slice().reverse().map(a=>(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 18px"},children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:a.item}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:4},children:[(0,e.jsx)("span",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",background:"var(--bg-card)",boxShadow:"var(--neu-inset-sm)",padding:"2px 10px",borderRadius:8},children:a.quantity}),(0,e.jsx)("span",{style:{fontSize:12,fontWeight:600,color:"HIGH"===a.urgency?"var(--coral)":"MEDIUM"===a.urgency?"var(--yellow)":"var(--text-muted)"},children:a.urgency})]}),(0,e.jsxs)("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["By ",d.find(b=>b.id===a.requesterId)?.name||"Staff"]})]}),(0,e.jsx)("div",{children:"FULFILLED"===a.status?(0,e.jsxs)("span",{className:"badge badge-green",style:{gap:4},children:[(0,e.jsx)(P,{size:12})," Done"]}):(0,e.jsxs)("span",{className:"badge badge-yellow",style:{gap:4},children:[(0,e.jsx)(u,{size:12})," Open"]})})]},a.id)),0===b.length&&(0,e.jsx)("div",{className:"neu-card-inset",style:{textAlign:"center",padding:"32px 20px",color:"var(--text-muted)",fontSize:13,fontWeight:500,fontStyle:"italic"},children:"No supply requests yet."})]})]})]})},aj=({type:a,label:b})=>(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:14,padding:"16px 18px"},children:[(0,e.jsx)("div",{style:{width:42,height:42,borderRadius:14,background:"IN"===a?"var(--green-light)":"var(--coral-light)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"IN"===a?(0,e.jsx)(B,{size:18,color:"#10b981"}):(0,e.jsx)(s,{size:18,color:"#f97066"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)"},children:b}),(0,e.jsx)("div",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)"},children:"IN"===a?"Clocked in":"Clocked out"})]})]}),ak=({currentUser:a,punchLogs:b,onPunch:c,staffMembers:d,isManagerView:g=!1})=>{let[h,i]=(0,f.useState)(new Date),j=d.find(b=>b.id===a);(0,f.useEffect)(()=>{let a=setInterval(()=>i(new Date),1e3);return()=>clearInterval(a)},[]);let k=new Date().setHours(0,0,0,0);if(g)return(0,e.jsxs)("div",{className:"animate-in",style:{paddingBottom:20},children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Staff Attendance Overview"})}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:d.map(a=>{let c=b.filter(b=>b.staffId===a.id&&b.timestamp>=k).sort((a,b)=>b.timestamp-a.timestamp),d=c[0]?.type==="IN",f=c[0]?new Date(c[0].timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A",g=[...c].sort((a,b)=>a.timestamp-b.timestamp);for(let a=0;a<g.length;a++)"IN"===g[a].type&&(g[a+1]?.type==="OUT"?g[a+1].timestamp:Date.now(),g[a].timestamp);return(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px"},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,e.jsx)("img",{src:a.avatar,alt:a.name,className:"avatar"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontWeight:700},children:a.name}),(0,e.jsx)("div",{style:{fontSize:11,color:"var(--text-muted)"},children:a.role})]})]}),(0,e.jsxs)("div",{style:{textAlign:"right"},children:[(0,e.jsx)("div",{style:{fontSize:12,fontWeight:700,color:d?"var(--green)":"var(--text-muted)",background:d?"var(--green-light)":"var(--bg-inset)",padding:"4px 8px",borderRadius:6,display:"inline-block",marginBottom:4},children:d?"ON DUTY":"OFF DUTY"}),(0,e.jsx)("div",{style:{fontSize:11,color:"var(--text-muted)"},children:d?`Since ${f}`:`Last: ${f}`})]})]},a.id)})})]});let l=b.filter(b=>b.staffId===a&&b.timestamp>=k).sort((a,b)=>b.timestamp-a.timestamp),m=l[0],n=m?.type==="IN",o=(()=>{let a=0,b=[...l].sort((a,b)=>a.timestamp-b.timestamp);for(let c=0;c<b.length;c++)"IN"===b[c].type&&(a+=(b[c+1]?.type==="OUT"?b[c+1].timestamp:Date.now())-b[c].timestamp);let c=Math.floor(a/6e4);return{hours:Math.floor(c/60),minutes:c%60}})(),p=Math.min(100,Math.round((60*o.hours+o.minutes)/480*100)),q=a=>new Date(a).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),r=2*Math.PI*92;return(0,e.jsxs)("div",{style:{paddingBottom:16},children:[(0,e.jsxs)("div",{className:"animate-in",style:{textAlign:"center",marginBottom:28},children:[(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)",marginBottom:4},children:"STAFF ATTENDANCE"}),(0,e.jsx)("h2",{style:{fontSize:22,fontWeight:800,color:"var(--text-primary)"},children:j?.name||"Staff"})]}),(0,e.jsx)("div",{className:"animate-in animate-in-delay-1",style:{display:"flex",justifyContent:"center",marginBottom:36},children:(0,e.jsxs)("button",{onClick:()=>{c({staffId:a,type:n?"OUT":"IN",timestamp:Date.now()})},className:`neu-punch-btn ${n?"punch-out":"punch-in"}`,children:[n?(0,e.jsx)(s,{size:36}):(0,e.jsx)(B,{size:36}),(0,e.jsx)("span",{style:{fontSize:18,fontWeight:800,textTransform:"uppercase",letterSpacing:1.5},children:n?"PUNCH OUT":"PUNCH IN"})]})}),(0,e.jsxs)("div",{className:"neu-card-inset animate-in animate-in-delay-2",style:{marginBottom:24,textAlign:"center",padding:28},children:[(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)",marginBottom:16},children:"HOURS WORKED TODAY:"}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:12},children:(0,e.jsxs)("div",{className:"progress-ring-container",style:{width:200,height:200},children:[(0,e.jsxs)("svg",{width:200,height:200,style:{transform:"rotate(-90deg)"},children:[(0,e.jsx)("circle",{cx:100,cy:100,r:92,fill:"none",stroke:"var(--neu-dark)",strokeWidth:16}),(0,e.jsx)("circle",{cx:100,cy:100,r:92,fill:"none",stroke:"url(#attendanceGradient)",strokeWidth:16,strokeDasharray:r,strokeDashoffset:r-p/100*r,strokeLinecap:"round",style:{transition:"stroke-dashoffset 1s ease-out"}}),(0,e.jsx)("defs",{children:(0,e.jsxs)("linearGradient",{id:"attendanceGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,e.jsx)("stop",{offset:"0%",stopColor:"#3b82f6"}),(0,e.jsx)("stop",{offset:"100%",stopColor:"#1d4ed8"})]})})]}),(0,e.jsxs)("div",{style:{position:"absolute",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,e.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",background:"var(--blue-light)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:8},children:(0,e.jsx)(u,{size:18,color:"#3b82f6"})}),(0,e.jsxs)("div",{style:{fontSize:28,fontWeight:800,color:"var(--text-primary)",lineHeight:1},children:[o.hours,"h ",o.minutes.toString().padStart(2,"0"),"m"]}),(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:.5,color:"var(--text-muted)",marginTop:4},children:"PROGRESS"})]})]})})]}),(0,e.jsxs)("div",{className:"animate-in animate-in-delay-3",children:[(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Recent Logs"})}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:0===l.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(aj,{type:"IN",time:"9:00 AM",label:"Punch In: 9:00 AM"}),(0,e.jsx)(aj,{type:"OUT",time:"1:00 PM",label:"Punch Out: 1:00 PM"}),(0,e.jsx)(aj,{type:"IN",time:"2:00 PM",label:"Punch In: 2:00 PM"})]}):l.map(a=>(0,e.jsx)(aj,{type:a.type,time:q(a.timestamp),label:`Punch ${"IN"===a.type?"In":"Out"}: ${q(a.timestamp)}`},a.id))})]})]})},al=k("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),am=k("wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),an=k("droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),ao=k("car-front",[["path",{d:"m21 8-2 2-1.5-3.7A2 2 0 0 0 15.646 5H8.4a2 2 0 0 0-1.903 1.257L5 10 3 8",key:"1imjwt"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 14h.01",key:"7oqj8z"}],["rect",{width:"18",height:"8",x:"3",y:"10",rx:"2",key:"a7itu8"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]]),ap=k("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),aq=k("gallery-vertical-end",[["path",{d:"M7 2h10",key:"nczekb"}],["path",{d:"M5 6h14",key:"u2x4p"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2",key:"l0tzu3"}]]),ar=k("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),as=k("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),at=({icon:a,count:b,label:c,color:d})=>(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[(0,e.jsx)("div",{style:{width:36,height:36,borderRadius:12,background:"var(--bg-card)",boxShadow:"var(--neu-raised-sm)",display:"flex",alignItems:"center",justifyContent:"center",color:d},children:a}),(0,e.jsx)("div",{style:{fontSize:16,fontWeight:800,color:"var(--text-primary)"},children:b}),(0,e.jsx)("div",{style:{fontSize:10,fontWeight:600,color:"var(--text-muted)"},children:c})]}),au=({logs:a,staffMembers:b,isAdmin:c})=>{let[d,g]=f.default.useState(new Date),h=new Date(d.getFullYear(),d.getMonth()+1,0).getDate(),i=new Date(d.getFullYear(),d.getMonth(),1).getDay(),j=Array.from({length:h},(a,b)=>b+1),k=Array.from({length:i},(a,b)=>b),l=a.filter(a=>{let b=new Date(a.timestamp);return b.getDate()===d.getDate()&&b.getMonth()===d.getMonth()&&b.getFullYear()===d.getFullYear()});return(0,e.jsxs)("div",{className:"animate-in",children:[(0,e.jsxs)("div",{className:"neu-card",style:{padding:20,marginBottom:20},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,e.jsx)("button",{onClick:()=>g(new Date(d.getFullYear(),d.getMonth()-1,1)),style:{border:"none",background:"none",fontSize:18,cursor:"pointer"},children:"â†"}),(0,e.jsx)("span",{style:{fontSize:16,fontWeight:700},children:d.toLocaleDateString("en-IN",{month:"long",year:"numeric"})}),(0,e.jsx)("button",{onClick:()=>g(new Date(d.getFullYear(),d.getMonth()+1,1)),style:{border:"none",background:"none",fontSize:18,cursor:"pointer"},children:"â†’"})]}),(0,e.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:8,textAlign:"center"},children:[["S","M","T","W","T","F","S"].map(a=>(0,e.jsx)("div",{style:{fontSize:10,fontWeight:700,color:"var(--text-muted)"},children:a},a)),k.map(a=>(0,e.jsx)("div",{},`blank-${a}`)),j.map(b=>{let c=new Date(d.getFullYear(),d.getMonth(),b).setHours(0,0,0,0),f=a.some(a=>new Date(a.timestamp).setHours(0,0,0,0)===c),h=b===d.getDate();return(0,e.jsx)("button",{onClick:()=>g(new Date(d.getFullYear(),d.getMonth(),b)),style:{width:32,height:32,borderRadius:"50%",border:"none",cursor:"pointer",background:h?"var(--blue)":f?"var(--green-light)":"transparent",color:h?"white":f?"var(--green)":"var(--text-primary)",fontWeight:h||f?700:400,margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"center"},children:b},b)})]})]}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:0===l.length?(0,e.jsx)("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:20,fontSize:13},children:"No activity on this date"}):l.map(a=>{let d=b.find(b=>b.id===a.staffId);return(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 16px"},children:[(0,e.jsx)("div",{style:{width:36,height:36,borderRadius:12,background:"var(--bg-inset)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,flexShrink:0},children:(a=>{let b={width:20,height:20};switch(a){case I.ROUTINE_HOUSEKEEPING:return(0,e.jsx)(al,{style:{...b,color:"#ef4444"}});case I.BROOMING:return(0,e.jsx)(am,{style:{...b,color:"#f97316"}});case I.MOPPING:return(0,e.jsx)(an,{style:{...b,color:"#3b82f6"}});case I.DRIVEWAY:return(0,e.jsx)(ao,{style:{...b,color:"#64748b"}});case I.GLASS_CLEANING:return(0,e.jsx)(ap,{style:{...b,color:"#06b6d4"}});case I.STAIRCASE:return(0,e.jsx)(aq,{style:{...b,color:"#8b5cf6"}});default:return(0,e.jsx)(ap,{style:{...b,color:"#94a3b8"}})}})(a.taskId.includes("Routine")?I.ROUTINE_HOUSEKEEPING:I.GLASS_CLEANING)}),(0,e.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,e.jsx)("div",{style:{fontSize:14,fontWeight:700,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a.taskId}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:4},children:[(0,e.jsxs)("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),c&&d&&(0,e.jsxs)("span",{style:{color:"var(--blue)",fontWeight:600,marginLeft:6},children:["â€¢ ",d.name.split(" ")[0]]})]}),a.block&&(0,e.jsxs)("div",{style:{fontSize:10,fontWeight:700,color:"var(--text-secondary)",background:"var(--bg-inset)",padding:"2px 6px",borderRadius:4},children:["B",a.block," ",a.flat?`- ${a.flat}`:""]})]})]})]},a.id)})})]})},av=({currentUser:a,logs:b,staffMembers:c,isAdmin:d=!1})=>{let g=(0,f.useMemo)(()=>d?b.sort((a,b)=>b.timestamp-a.timestamp):b.filter(b=>b.staffId===a).sort((a,b)=>b.timestamp-a.timestamp),[b,a,d]),h=new Date().setHours(0,0,0,0),i=new Date().setDate(new Date().getDate()-7),j=(0,f.useMemo)(()=>{let a=g.filter(a=>a.timestamp>=h).length,b=g.filter(a=>a.timestamp>=i).length,c=g.filter(a=>a.taskId.includes("Routine")||a.taskId.includes("Garbage")).length,d=g.filter(a=>a.taskId.includes("broom")||a.taskId.includes("sweep")).length,e=g.filter(a=>a.taskId.includes("mop")).length,f=g.length-c-d-e;return{todayCount:a,weekCount:b,breakdown:{garbage:c,brooming:d,mopping:e,other:f}}},[g,h,i]);return(0,f.useMemo)(()=>{let a={};return g.forEach(b=>{let c=new Date(b.timestamp).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"});a[c]||(a[c]=[]),a[c].push(b)}),a},[g]),(0,e.jsxs)("div",{className:"animate-in",children:[(0,e.jsxs)("div",{className:"section-header",children:[(0,e.jsx)("span",{className:"section-title",children:"Performance Overview"}),(0,e.jsx)("span",{className:"section-label",children:"LIVE STATS"})]}),(0,e.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"20px 16px"},children:[(0,e.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"var(--green-light)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12,color:"var(--green)"},children:(0,e.jsx)(ar,{size:24})}),(0,e.jsx)("div",{style:{fontSize:24,fontWeight:800,color:"var(--text-primary)",lineHeight:1.2},children:j.todayCount}),(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",marginTop:4},children:"Tasks Today"})]}),(0,e.jsxs)("div",{className:"neu-card",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"20px 16px"},children:[(0,e.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"var(--blue-light)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12,color:"var(--blue)"},children:(0,e.jsx)(as,{size:24})}),(0,e.jsx)("div",{style:{fontSize:24,fontWeight:800,color:"var(--text-primary)",lineHeight:1.2},children:j.weekCount}),(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",marginTop:4},children:"Tasks This Week"})]})]}),(0,e.jsxs)("div",{className:"neu-card-inset",style:{padding:20,marginBottom:24},children:[(0,e.jsx)("div",{className:"section-header",style:{marginBottom:16},children:(0,e.jsx)("span",{className:"section-label",children:"WORK BREAKDOWN"})}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[(0,e.jsx)(at,{icon:(0,e.jsx)(al,{size:16}),count:j.breakdown.garbage,label:"Garbage",color:"var(--red)"}),(0,e.jsx)(at,{icon:(0,e.jsx)(am,{size:16}),count:j.breakdown.brooming,label:"Brooming",color:"var(--orange)"}),(0,e.jsx)(at,{icon:(0,e.jsx)(ap,{size:16}),count:j.breakdown.mopping,label:"Mopping",color:"var(--blue)"})]})]}),(0,e.jsx)("div",{className:"section-header",children:(0,e.jsx)("span",{className:"section-title",children:"Activity History"})}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:24}}),(0,e.jsx)(au,{logs:g,staffMembers:c,isAdmin:d}),0===g.length&&(0,e.jsxs)("div",{style:{textAlign:"center",padding:"40px 0",color:"var(--text-muted)"},children:[(0,e.jsx)("div",{style:{fontSize:40,marginBottom:10},children:"ðŸ“œ"}),(0,e.jsx)("div",{style:{fontWeight:600},children:"No logs found"}),(0,e.jsx)("div",{style:{fontSize:12},children:"Get started by completing tasks!"})]})]})},aw=({icon:a,label:b,active:c,onClick:d})=>(0,e.jsxs)("button",{className:`nav-item ${c?"active":""}`,onClick:d,children:[a,(0,e.jsx)("span",{children:b})]}),ax=()=>{let{isLoggedIn:a,role:b,staffId:c,staffName:d,loading:g,logout:h}=(0,w.useAuth)(),[i,j]=(0,f.useState)(1),[k,x]=(0,f.useState)("HOME"),[y,z]=(0,f.useState)("TASKS"),[A,B]=(0,f.useState)(!1),[C,D]=(0,f.useState)(new Date);(0,f.useEffect)(()=>{let a=setInterval(()=>D(new Date),1e3);return()=>clearInterval(a)},[]);let[E,F]=(0,f.useState)([]),[I,J]=(0,f.useState)([]),[K,L]=(0,f.useState)([]),[M,N]=(0,f.useState)([]),[O,P]=(0,f.useState)(!1);(0,f.useEffect)(()=>{c&&j(c)},[c]),(0,f.useEffect)(()=>{a&&(P(!0),Promise.all([(0,G.fetchStaffMembers)().catch(()=>[]),(0,G.fetchTaskLogs)().catch(()=>[]),(0,G.fetchPunchLogs)().catch(()=>[]),(0,G.fetchSupplyRequests)().catch(()=>[])]).then(([a,b,c,d])=>{F(a),J(b),N(c),L(d),P(!1)}))},[a]);let Q=async a=>{try{let b=await (0,G.insertTaskLog)(a);J(a=>[b,...a])}catch{let b={...a,id:Math.random().toString(36).substr(2,9)};J(a=>[b,...a])}},R=async a=>{try{let b=await (0,G.insertSupplyRequest)(a);L(a=>[b,...a])}catch{let b={...a,id:Math.random().toString(36).substr(2,9)};L(a=>[b,...a])}},S=async a=>{try{await (0,G.updateSupplyStatus)(a,"FULFILLED")}catch{}L(b=>b.map(b=>b.id===a?{...b,status:"FULFILLED"}:b))},T=async a=>{try{await (0,G.updateSupplyStatus)(a,"REJECTED")}catch{}L(b=>b.map(b=>b.id===a?{...b,status:"REJECTED"}:b))},U=async a=>{try{let b=await (0,G.insertPunchLog)(a);N(a=>[b,...a])}catch{let b={...a,id:Math.random().toString(36).substr(2,9)};N(a=>[b,...a])}},V=()=>{if(0===I.length)return void alert("No logs to export.");let a=new Blob([["Date,Time,Staff,Task,Type,Block,Floor,Flat,Status",...I.map(a=>[new Date(a.timestamp).toLocaleDateString(),new Date(a.timestamp).toLocaleTimeString(),E.find(b=>b.id===a.staffId)?.name||"Unknown",a.taskId,"Task",a.block||"-",void 0!==a.floor?a.floor:"-",a.flat||"-",a.status].join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),c=URL.createObjectURL(a);b.setAttribute("href",c),b.setAttribute("download",`society_logs_${new Date().toISOString().split("T")[0]}.csv`),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)};if(g)return(0,e.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg)"},children:(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)(t,{size:40,className:"spin",style:{color:"var(--blue)",marginBottom:16}}),(0,e.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-muted)"},children:"Loading..."})]})});if(!a)return(0,e.jsx)(H,{});let W="admin"===b,X=d||"User",Y=()=>W?"HOME"===k?"MANAGEMENT":"STAFF"===k?"STAFF ATTENDANCE":"":"ATTENDANCE"===y?"STAFF ATTENDANCE":X;return(0,e.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",maxWidth:430,margin:"0 auto",position:"relative"},children:[(0,e.jsxs)("header",{className:"app-header",children:[(0,e.jsxs)("div",{children:[Y()&&(0,e.jsx)("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)",marginBottom:2},children:Y()}),(0,e.jsx)("h1",{style:{fontSize:22,fontWeight:800,color:"var(--text-primary)",lineHeight:1.2,whiteSpace:"pre-line"},children:W?"HOME"===k?"Admin\nManagement Hub":"STAFF"===k?"Staff Attendance":"STOCK"===k?"Supplies":"Reports":"ATTENDANCE"===y?"Staff Attendance":"STOCK"===y?"Supplies":"My Tasks"}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:6},children:[(0,e.jsx)(u,{size:13,style:{color:"var(--text-muted)"}}),(0,e.jsxs)("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",fontVariantNumeric:"tabular-nums"},children:[C.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})," Â· ",C.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})]})]})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,e.jsx)("button",{className:"neu-dark-toggle",onClick:()=>{B(!A),document.body.classList.toggle("dark-mode")},children:A?(0,e.jsx)(q,{size:18}):(0,e.jsx)(p,{size:18})}),(0,e.jsxs)("button",{className:"neu-logout-btn",onClick:h,children:[(0,e.jsx)(s,{size:14}),(0,e.jsx)("span",{children:"Logout"})]})]})]}),(0,e.jsxs)("main",{style:{flex:1,padding:"0 16px 100px",overflowY:"auto"},children:[(()=>{if(O)return(0,e.jsxs)("div",{style:{textAlign:"center",padding:60},children:[(0,e.jsx)(t,{size:32,className:"spin",style:{color:"var(--blue)"}}),(0,e.jsx)("div",{style:{marginTop:12,fontSize:13,color:"var(--text-muted)"},children:"Loading data..."})]});if(W)switch(k){case"HOME":default:return(0,e.jsx)(_,{logs:I,tasks:[],supplyRequests:K,onApproveSupply:S,onRejectSupply:T,staffMembers:E,punchLogs:M,onNavigate:a=>x(a),onExport:V});case"STAFF":return(0,e.jsx)(ak,{currentUser:i,punchLogs:M,onPunch:U,staffMembers:E,isManagerView:!0});case"STOCK":return(0,e.jsx)(ai,{currentUser:i,requests:K,onRequest:R,staffMembers:E,isManagerView:!0});case"LOGS":return(0,e.jsx)(av,{currentUser:i,logs:I,staffMembers:E,isAdmin:!0})}switch(y){case"ATTENDANCE":return(0,e.jsx)(ak,{currentUser:i,punchLogs:M,onPunch:U,staffMembers:E});case"STOCK":return(0,e.jsx)(ai,{currentUser:i,requests:K,onRequest:R,staffMembers:E});case"LOGS":return(0,e.jsx)(av,{currentUser:i,logs:I,staffMembers:E});default:return(0,e.jsx)(af,{currentUser:i,logs:I,onLogTask:Q,staffMembers:E})}})(),(0,e.jsx)(v,{})]}),W?(0,e.jsxs)("div",{className:"bottom-nav",children:[(0,e.jsx)(aw,{icon:(0,e.jsx)(l,{size:22}),label:"Home",active:"HOME"===k,onClick:()=>x("HOME")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(m,{size:22}),label:"Staff",active:"STAFF"===k,onClick:()=>x("STAFF")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(n,{size:22}),label:"Stock",active:"STOCK"===k,onClick:()=>x("STOCK")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(o,{size:22}),label:"Logs",active:"LOGS"===k,onClick:()=>x("LOGS")})]}):(0,e.jsxs)("div",{className:"bottom-nav",children:[(0,e.jsx)(aw,{icon:(0,e.jsx)(r,{size:22}),label:"Tasks",active:"TASKS"===y,onClick:()=>z("TASKS")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(m,{size:22}),label:"Staff",active:"ATTENDANCE"===y,onClick:()=>z("ATTENDANCE")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(n,{size:22}),label:"Stock",active:"STOCK"===y,onClick:()=>z("STOCK")}),(0,e.jsx)(aw,{icon:(0,e.jsx)(o,{size:22}),label:"Logs",active:"LOGS"===y,onClick:()=>z("LOGS")})]})]})};function ay(){return(0,e.jsx)(ax,{})}a.s(["default",()=>ay],60350)}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map